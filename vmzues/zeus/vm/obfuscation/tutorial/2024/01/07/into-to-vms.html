<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Introduction To VM Protection - VMZeus | OALABS Research</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Introduction To VM Protection - VMZeus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reverse Engineering VM obfuscation" />
<meta property="og:description" content="Reverse Engineering VM obfuscation" />
<link rel="canonical" href="https://research.openanalysis.net/vmzues/zeus/vm/obfuscation/tutorial/2024/01/07/into-to-vms.html" />
<meta property="og:url" content="https://research.openanalysis.net/vmzues/zeus/vm/obfuscation/tutorial/2024/01/07/into-to-vms.html" />
<meta property="og:site_name" content="OALABS Research" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-07T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Introduction To VM Protection - VMZeus" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-07T00:00:00-06:00","datePublished":"2024-01-07T00:00:00-06:00","description":"Reverse Engineering VM obfuscation","headline":"Introduction To VM Protection - VMZeus","mainEntityOfPage":{"@type":"WebPage","@id":"https://research.openanalysis.net/vmzues/zeus/vm/obfuscation/tutorial/2024/01/07/into-to-vms.html"},"url":"https://research.openanalysis.net/vmzues/zeus/vm/obfuscation/tutorial/2024/01/07/into-to-vms.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://research.openanalysis.net/feed.xml" title="OALABS Research" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">OALABS Research</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction To VM Protection - VMZeus</h1><p class="page-description">Reverse Engineering VM obfuscation</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2024-01-07T00:00:00-06:00" itemprop="datePublished">
        Jan 7, 2024
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#vmzues">vmzues</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#zeus">zeus</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#vm">vm</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#obfuscation">obfuscation</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#tutorial">tutorial</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-left">
            <div class="px-2">
                <a href="https://www.youtube.com/c/OALabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-YouTube-FF0000" alt="Join us on YouTube">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.twitch.tv/oalabslive" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/twitch/status/oalabslive?style=social" alt="Join us on Twitch">
                </a>
            </div>
            <div class="px-2">
                <a href="https://discord.gg/cw4U3WHvpn" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-Join Our Discord-blueviolet" alt="Join Discord">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.patreon.com/oalabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-OALABS Patreon-FF424D" alt="Support us on Patreon">
                </a>
            </div>
          <div class="px-2">

    <a href="https://github.com/OALabs/research/tree/master/_notebooks/2024-01-07-into-to-vms.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Overview">Overview </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Sample">Sample </a></li>
<li class="toc-entry toc-h3"><a href="#References">References </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Analysis">Analysis </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Instruction-Set-Archetecture">Instruction Set Archetecture </a></li>
<li class="toc-entry toc-h3"><a href="#Instruction-Pointer">Instruction Pointer </a></li>
<li class="toc-entry toc-h3"><a href="#Data">Data </a></li>
<li class="toc-entry toc-h3"><a href="#Context">Context </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Marking-Up-Instruction-Handlers">Marking Up Instruction Handlers </a></li>
<li class="toc-entry toc-h2"><a href="#Instruction-Handlers">Instruction Handlers </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2024-01-07-into-to-vms.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">
<a class="anchor" href="#Overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview<a class="anchor-link" href="#Overview"> </a>
</h2>
<p>We are going to take a look at one of the original "VM" protections used in malware, VM Zeus. Zeus is one of the orignal "botnets" that put ecrime on the map. The sourcecode was sold (and eventually leaked) which lead to many different variants. One of the variants implemented a custom VM that was used to protect the configuration file... known as VM Zeus (KINS).</p>
<p>Many of the Zeus variants have been catalogued in the the <a href="https://zeusmuseum.com/">ZeusMuseum</a> curated by <a href="https://twitter.com/tildedennis">@tildedennis</a>.</p>
<p>In this analysis we are going to focus on the VM mechanics, how it works, and how to analyze it, as a way to understand VM protection fundamentals. There is a lot of prior research on this VM that we will reference below.</p>
<h3 id="Sample">
<a class="anchor" href="#Sample" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample<a class="anchor-link" href="#Sample"> </a>
</h3>
<p><code>f792997cb36a477fa55102ad6b680c97e3517b2e63c83c802bf8d57ae9ed525e</code> <a href="https://www.unpac.me/results/bb557f46-a12a-4737-a638-787f982963fd?hash=f792997cb36a477fa55102ad6b680c97e3517b2e63c83c802bf8d57ae9ed525e#/">UnpacMe</a></p>
<h3 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h3>
<ul>
<li><a href="https://repo.zenk-security.com/Virus-Infections-Detections-Preventions/Botconf-ZeuS-Meets-VM-Story-so-Far.pdf">ZeuS meets VM (BotConf 2014)</a></li>
<li>PNX -- can't find references to his work?</li>
<li><a href="https://miasm.re/blog/2016/09/03/zeusvm_analysis.html">ZeusVM analysis - MIASM</a></li>
<li><a href="https://github.com/rung/ABD">Advanced Binary Deobfuscation Course</a></li>
<li><a href="https://secret.club/2023/12/24/riscy-business.html">Not directly related but interesting work on building a VM -- RISC-Y Business</a></li>
<li><a href="https://www.jmeiners.com/lc3-vm/#-lc3.c-block-99">Interesting VM building tutorail</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Analysis">
<a class="anchor" href="#Analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Analysis<a class="anchor-link" href="#Analysis"> </a>
</h2>
<p>The VM consists of a dispatcher, a set of instructions handlers, a constant byte array with the <strong>code</strong> and a constant byte array with the <strong>data</strong>.</p>
<div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">__usercall</span> <span class="n">mw_vm</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">arg_data</span><span class="err">@</span><span class="o">&lt;</span><span class="n">esi</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">byte</span> <span class="o">*</span><span class="n">var_code_buff</span><span class="p">;</span> <span class="c1">// edi</span>
  <span class="n">ctxt</span> <span class="n">ctxt</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-4Ch] BYREF</span>

  <span class="n">var_code_buff</span> <span class="o">=</span> <span class="n">mw_cpy_to_buff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g_code</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x1000</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">var_code_buff</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">mw_wrap_cpy</span><span class="p">(</span><span class="n">arg_data</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g_data</span><span class="p">,</span> <span class="mh">0x370u</span><span class="p">);</span>
    <span class="n">ctxt</span><span class="p">.</span><span class="n">value0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">ctxt</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="n">arg_data</span><span class="p">;</span>
    <span class="n">ctxt</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">var_code_buff</span><span class="p">;</span>
    <span class="n">g_data_buff</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">arg_data</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="p">((</span><span class="kt">char</span> <span class="p">(</span><span class="n">__thiscall</span> <span class="o">*</span><span class="p">)(</span><span class="n">ctxt</span> <span class="o">*</span><span class="p">))</span><span class="n">ptr_instructions</span><span class="p">[</span><span class="o">*</span><span class="n">ctxt</span><span class="p">.</span><span class="n">code</span><span class="p">])(</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="p">)</span> <span class="p">)</span>
      <span class="p">;</span>
    <span class="n">mw_wrap_heap_free</span><span class="p">(</span><span class="n">var_code_buff</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="Instruction-Set-Archetecture">
<a class="anchor" href="#Instruction-Set-Archetecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Instruction Set Archetecture<a class="anchor-link" href="#Instruction-Set-Archetecture"> </a>
</h3>
<ul>
<li>opcode is 1 byte</li>
<li>operands can be immediate or register index</li>
<li>regsiters are numerically indexed from 0-15</li>
</ul>
<h3 id="Instruction-Pointer">
<a class="anchor" href="#Instruction-Pointer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Instruction Pointer<a class="anchor-link" href="#Instruction-Pointer"> </a>
</h3>
<ul>
<li>next opcode is decrypted using unique hard-coded byte for each handler, and last byte of previous instruction</li>
<li>code buffer is incremented in handler</li>
</ul>
<h3 id="Data">
<a class="anchor" href="#Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data<a class="anchor-link" href="#Data"> </a>
</h3>
<p>There is a shared data buffer that is pre-populated with data but is also used like stack during instruction execution. Unclear what to call this.</p>
<h3 id="Context">
<a class="anchor" href="#Context" aria-hidden="true"><span class="octicon octicon-link"></span></a>Context<a class="anchor-link" href="#Context"> </a>
</h3>
<p>The VM context is used to pass the code buffer, data buffer, and registers to the instruction handlers. The <code>value0</code> is likely flags but not confirmed yet!</p>
<div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nf">__declspec</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="n">ctxt</span>
<span class="p">{</span>
  <span class="n">byte</span> <span class="o">*</span><span class="n">code</span><span class="p">;</span>
  <span class="n">byte</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
  <span class="n">DWORD</span> <span class="n">value0</span><span class="p">;</span>
  <span class="n">DWORD</span> <span class="n">regs</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>
<h2 id="Marking-Up-Instruction-Handlers">
<a class="anchor" href="#Marking-Up-Instruction-Handlers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Marking Up Instruction Handlers<a class="anchor-link" href="#Marking-Up-Instruction-Handlers"> </a>
</h2>
<p>Thanks to this nice script from "anonymous" (not THAT anonymous) we can mark up a few instructions and notice a pattern.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">idaapi</span>
<span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="mh">0x429D6D</span><span class="p">,</span><span class="mh">0x429DA1</span><span class="p">,</span><span class="mh">0x429DD8</span><span class="p">,</span><span class="mh">0x429CDB</span><span class="p">,</span><span class="mh">0x429D0C</span><span class="p">,</span><span class="mh">0x429D3D</span><span class="p">,</span><span class="mh">0x429F59</span><span class="p">,</span><span class="mh">0x429F8F</span><span class="p">,</span><span class="mh">0x429FC8</span><span class="p">,</span><span class="mh">0x429EB3</span><span class="p">,</span><span class="mh">0x429EE9</span><span class="p">,</span><span class="mh">0x429F22</span><span class="p">,</span><span class="mh">0x429E0D</span><span class="p">,</span><span class="mh">0x429E43</span><span class="p">,</span><span class="mh">0x429E7C</span><span class="p">,</span><span class="mh">0x429BA5</span><span class="p">,</span><span class="mh">0x429BDC</span><span class="p">,</span><span class="mh">0x429C13</span><span class="p">]</span>

<span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
    <span class="n">idc</span><span class="o">.</span><span class="n">SetType</span><span class="p">(</span><span class="n">func</span> <span class="p">,</span> <span class="s2">"char __thiscall sub_429C13(struct ctxt *this)"</span><span class="p">)</span>


<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429D6D</span><span class="p">,</span> <span class="s2">"mw_push_reg_to_data_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429DA1</span><span class="p">,</span> <span class="s2">"mw_push_reg_to_data_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429DD8</span><span class="p">,</span> <span class="s2">"mw_push_reg_to_data_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>

<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429CDB</span><span class="p">,</span> <span class="s2">"mw_pop_data_to_reg_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429D0C</span><span class="p">,</span> <span class="s2">"mw_pop_data_to_reg_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429D3D</span><span class="p">,</span> <span class="s2">"mw_pop_data_to_reg_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>

<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429F59</span><span class="p">,</span> <span class="s2">"mw_xor_data_with_reg_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429F8F</span><span class="p">,</span> <span class="s2">"mw_xor_data_with_reg_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429FC8</span><span class="p">,</span> <span class="s2">"mw_xor_data_with_reg_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>


<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429EB3</span><span class="p">,</span> <span class="s2">"mw_subs_reg_from_data_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429EE9</span><span class="p">,</span> <span class="s2">"mw_subs_reg_from_data_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429F22</span><span class="p">,</span> <span class="s2">"mw_subs_reg_from_data_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>

<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429E0D</span><span class="p">,</span> <span class="s2">"mw_add_reg_to_data_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429E43</span><span class="p">,</span> <span class="s2">"mw_add_reg_to_data_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429E7C</span><span class="p">,</span> <span class="s2">"mw_add_reg_to_data_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>


<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429BA5</span><span class="p">,</span> <span class="s2">"mw_mov_reg2_to_reg1_b"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429BDC</span><span class="p">,</span> <span class="s2">"mw_mov_reg2_to_reg1_w"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
<span class="n">idaapi</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="mh">0x429C13</span><span class="p">,</span> <span class="s2">"mw_mov_reg2_to_reg1_dw"</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">SN_FORCE</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Instruction-Handlers">
<a class="anchor" href="#Instruction-Handlers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Instruction Handlers<a class="anchor-link" href="#Instruction-Handlers"> </a>
</h2>
<pre><code>h_nop_b
h_nop_w
h_nop_dw
h_xor_data_imm_b
h_xor_data_imm_w
h_xor_data_imm_dw
h_add_data_imm_b
h_add_data_imm_w
h_add_data_imm_dw
h_sub_data_imm_b
h_sub_data_imm_w
h_sub_data_imm_dw
h_rol_b_data_b
h_rol_w_data_b
h_rol_dw_data_b
h_ror_b_data_b
h_ror_w_data_b
h_ror_dw_data_b
h_not_b_data
h_not_w_data
h_not_dw_data
h_dw_data_shuffle
h_rc4
h_set_value_imm_b
h_set_value_imm_w
h_set_value_imm_dw
h_add_data_imm_w
h_loop_b
h_loop_w
h_mov_reg_imm_b
h_mov_reg_imm_w
h_mov_reg_imm_dw
h_mov_reg_reg_b
h_mov_reg_reg_w
h_mov_reg_reg_dw
h_add_reg_reg_b
h_add_reg_reg_w
h_add_reg_reg_dw
h_sub_reg_reg_b
h_sub_reg_reg_w
h_sub_reg_reg_dw
h_xor_reg2_to_reg1_b
h_xor_reg2_to_reg1_w
h_xor_reg2_to_reg1_dw
h_reg_add_imm_b
h_reg_add_imm_w
h_reg_add_imm_dw
h_reg_sub_imm_b
h_reg_sub_imm_w
h_reg_sub_imm_dw
h_reg_xor_imm_b
h_reg_xor_imm_w
h_reg_xor_imm_dw
mw_add_reg_to_data_b
mw_add_reg_to_data_w
mw_add_reg_to_data_dw
mw_subs_reg_from_data_b
mw_subs_reg_from_data_w
mw_subs_reg_from_data_dw
mw_xor_data_with_reg_b
mw_xor_data_with_reg_w
mw_xor_data_with_reg_dw
h_mov_data_to_reg_b
h_mov_data_to_reg_w
h_mov_data_to_reg_dw
mw_push_reg_to_data_b
mw_push_reg_to_data_w
mw_push_reg_to_data_dw
h_vm_exit</code></pre>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/vmzues/zeus/vm/obfuscation/tutorial/2024/01/07/into-to-vms.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>

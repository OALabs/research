<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Bumblebee Loader | OALABS Research</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Bumblebee Loader" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Taking a look at Bumblebee loader" />
<meta property="og:description" content="Taking a look at Bumblebee loader" />
<link rel="canonical" href="https://research.openanalysis.net/bumblebee/malware/loader/unpacking/2022/05/12/bumblebee_loader.html" />
<meta property="og:url" content="https://research.openanalysis.net/bumblebee/malware/loader/unpacking/2022/05/12/bumblebee_loader.html" />
<meta property="og:site_name" content="OALABS Research" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-12T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bumblebee Loader" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-12T00:00:00-05:00","datePublished":"2022-05-12T00:00:00-05:00","description":"Taking a look at Bumblebee loader","headline":"Bumblebee Loader","mainEntityOfPage":{"@type":"WebPage","@id":"https://research.openanalysis.net/bumblebee/malware/loader/unpacking/2022/05/12/bumblebee_loader.html"},"url":"https://research.openanalysis.net/bumblebee/malware/loader/unpacking/2022/05/12/bumblebee_loader.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://research.openanalysis.net/feed.xml" title="OALABS Research" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">OALABS Research</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Bumblebee Loader</h1><p class="page-description">Taking a look at Bumblebee loader</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-05-12T00:00:00-05:00" itemprop="datePublished">
        May 12, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#bumblebee">bumblebee</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#malware">malware</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#loader">loader</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#unpacking">unpacking</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-left">
            <div class="px-2">
                <a href="https://www.youtube.com/c/OALabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-YouTube-FF0000" alt="Join us on YouTube">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.twitch.tv/oalabslive" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/twitch/status/oalabslive?style=social" alt="Join us on Twitch">
                </a>
            </div>
            <div class="px-2">
                <a href="https://discord.gg/cw4U3WHvpn" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-Join Our Discord-blueviolet" alt="Join Discord">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.patreon.com/oalabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-OALABS Patreon-FF424D" alt="Support us on Patreon">
                </a>
            </div>
          <div class="px-2">

    <a href="https://github.com/OALabs/research/tree/master/_notebooks/2022-05-12-bumblebee_loader.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Overview">Overview </a>
<ul>
<li class="toc-entry toc-h3"><a href="#References">References </a></li>
<li class="toc-entry toc-h3"><a href="#Sample">Sample </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Triage">Triage </a></li>
<li class="toc-entry toc-h2"><a href="#Unpacking">Unpacking </a></li>
<li class="toc-entry toc-h2"><a href="#Payload">Payload </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Build-Artifacts">Build Artifacts </a></li>
<li class="toc-entry toc-h3"><a href="#Anti-Analysis">Anti-Analysis </a>
<ul>
<li class="toc-entry toc-h4"><a href="#IDA-Filtering">IDA Filtering </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Config">Config </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Decrypted-Config-String">Decrypted Config String </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-05-12-bumblebee_loader.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">
<a class="anchor" href="#Overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview<a class="anchor-link" href="#Overview"> </a>
</h2>
<p>According to Google's Threat Analysis Group...</p>
<blockquote>
<p>The loader can be recognized by its use of a unique user-agent “bumblebee” which both variants share. The malware, hence dubbed BUMBLEBEE.</p>
</blockquote>
<p>This loader has been observed downloading payloads such as cobalt strike and is often delivered itself via an ISO file. The sample we are strating with today is an ISO.</p>
<h3 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h3>
<ul>
<li>
<a href="https://elis531989.medium.com/the-chronicles-of-bumblebee-the-hook-the-bee-and-the-trickbot-connection-686379311056">The chronicles of Bumblebee:The Hook, the Bee, and the Trickbot connection</a>- <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.bumblebee">Malpedia</a>
</li>
<li><a href="https://blog.google/threat-analysis-group/exposing-initial-access-broker-ties-conti/">Exposing initial access broker with ties to Conti</a></li>
<li><a href="https://code.google.com/archive/p/lnk-parser/downloads">lnk file parser</a></li>
</ul>
<h3 id="Sample">
<a class="anchor" href="#Sample" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample<a class="anchor-link" href="#Sample"> </a>
</h3>
<p><a href="https://bazaar.abuse.ch/download/0d740a348362171814cb314a48d763e336407904a36fa278eaf390c5743ec33b/">0d740a348362171814cb314a48d763e336407904a36fa278eaf390c5743ec33b</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Triage">
<a class="anchor" href="#Triage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Triage<a class="anchor-link" href="#Triage"> </a>
</h2>
<p>The ISO contains two files <code>desk.dll</code> and <code>New Folder.Lnk</code>. We can right click <code>properties</code> on the lnk file to take a look at its command. The lnk file is used to launch the dll with the following command.</p>

<pre><code>C:\Windows\System32\rundll32.exe desk.dll,aCmHmjrptS</code></pre>
<h2 id="Unpacking">
<a class="anchor" href="#Unpacking" aria-hidden="true"><span class="octicon octicon-link"></span></a>Unpacking<a class="anchor-link" href="#Unpacking"> </a>
</h2>
<ul>
<li>load rundll32.exe in x64dbg and change the command line to pass <code>desk.dll,#1</code>
</li>
<li>enable break on dll load</li>
<li>once <code>desk.dll</code> is loaded locate export we want to debug (<code>aCmHmjrptS</code> ord 1) and add a hardware breakpoint</li>
<li>remove the break on dll load and run until the export is bp is hit</li>
<li>we initially tried watching for allocated memory via <code>VirutalAllocEx</code> but didn't see anything interesting</li>
<li>instead we eneabled break on exit and just ran the dll </li>
<li>when the break on exit was hit we searched memory for the PE header DOS string and located a mapped PE</li>
<li>we unmapped the PE to reveal the payload</li>
</ul>
<h2 id="Payload">
<a class="anchor" href="#Payload" aria-hidden="true"><span class="octicon octicon-link"></span></a>Payload<a class="anchor-link" href="#Payload"> </a>
</h2>
<p>Unpacked and unmapped payload <code>abaa83ab368cbd3bbdaf7dd844251da61a571974de9fd27f5dbaed945b7c38f6</code> available on <a href="https://malshare.com/sample.php?action=detail&amp;hash=abaa83ab368cbd3bbdaf7dd844251da61a571974de9fd27f5dbaed945b7c38f6">malshare</a>.</p>
<h3 id="Build-Artifacts">
<a class="anchor" href="#Build-Artifacts" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build Artifacts<a class="anchor-link" href="#Build-Artifacts"> </a>
</h3>
<p>There is a build artifact that may be useful for hunting other samples.</p>

<pre><code>Z:\hooker2\Common\md5.cpp</code></pre>
<p>We searched for this on <a href="https://www.virustotal.com/gui/search/content%253A%257B5a003a005c0068006f006f006b006500720032005c00%257D/files">VirusTotal</a> using the search term <code>https://www.virustotal.com/gui/search/content%253A%257B5a003a005c0068006f006f006b006500720032005c00%257D/files</code> and found other sample but nothing too interesting.</p>
<h3 id="Anti-Analysis">
<a class="anchor" href="#Anti-Analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Anti-Analysis<a class="anchor-link" href="#Anti-Analysis"> </a>
</h3>
<p>There are many anti-analysis checks some of which have been directly copied from the open source project <a href="https://github.com/LordNoteworthy/al-khaser">al-khaser</a>. To get some free work we compiled al-khaser and created and IDB using a build version with symbols. We when used <a href="https://www.zynamics.com/bindiff.html">bindiff</a> to match the al-khaser IDB with the payload. This allowed us to import all of the symbols from al-khaser.</p>
<h4 id="IDA-Filtering">
<a class="anchor" href="#IDA-Filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>IDA Filtering<a class="anchor-link" href="#IDA-Filtering"> </a>
</h4>
<p>While using BinDiff we ran into some issues with the IDA filter not working correcte (we were trying to filter out std and internal functions). To get the filter to work correctly we needed use a specific order shown below.
<img src="https://i.imgur.com/FTvp1T2.png" alt=""></p>
<h3 id="Config">
<a class="anchor" href="#Config" aria-hidden="true"><span class="octicon octicon-link"></span></a>Config<a class="anchor-link" href="#Config"> </a>
</h3>
<p>Instead of a config the payload contains a series of encrypted strings in the <code>.data</code> section. These strings include the campaign name and a C2 list. The encryption is <strong>RC4</strong> and the key is a hard-coded plaintext string (also in the <code>.data</code> section). In our sample the key was <code>BLACK</code>.</p>
<h4 id="Decrypted-Config-String">
<a class="anchor" href="#Decrypted-Config-String" aria-hidden="true"><span class="octicon octicon-link"></span></a>Decrypted Config String<a class="anchor-link" href="#Decrypted-Config-String"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">unhex</span><span class="p">(</span><span class="n">hex_string</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">binascii</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">hex_string</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">hex_string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">hex_string</span><span class="p">)</span>

    
<span class="k">def</span> <span class="nf">tohex</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">binascii</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rc4crypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="c1">#If the input is a string convert to byte arrays</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">box</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span> <span class="o">%</span> <span class="mi">256</span>
        <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
        <span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span> <span class="o">^</span> <span class="n">box</span><span class="p">[(</span><span class="n">box</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">y</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">'</span><span class="se">\x47\xCB\xD6\x45\x96\xAD\x39\x36\x82\x64\xA3\x68\xBB\x80\x5C\x8F\x4F\x86\x35\x73\xFD\xE9\x2E\x6D\x8C\x70\xB2\xE5\xEE\xD3\xC6\x11\x60\xA2\x12\x6A\x84\xC3\x52\x7A\x3C\x75\x3F\x26\x60\x58\xF2\x4F\x5E\x74\xBE\xA9\xAF\xEE\x84\xC7\x85\x54\x13\x63\xC1\x70\xBF\x40\xE5\xC7\x8F\xF0\xBE\xB5\xF0\xBA\x61\x7C\x53\xF6\x4B\xB9\x19\x7B\xE1\xA0\xD9\xB4\x59\xC3\x37\x0B\x31\x93\xC3\x16\x95\x64\x5F\xE1\x5F\xDD\x62\x89\xAA\x39\x08\x8C\x8E\xDC\xC1\x94\xB8\x4C\x3F\x96\x97\x05\x06\xC4\xA4\xCA\xB6\x7A\x96\x3A\x84\x2B\xFD\x9B\x26\x9A\x3C\x8A\x17\x3C\xF9\x9C\xCA\x43\x36\xBC\x4D\x54\x7B\x91\x0D\x05\xC7\x0E\x7A\x6B\x97\x36\xD2\xDD\x53\x4D\xB1\xDD\xCB\xCF\xC6\xF6\x3A\xC8\x02\xF2\xCF\x6C\x4D\xF2\xD4\x35\xB6\x58\x73\x9D\xBE\x48\xA0\xF8\x9D\x5D\x87\xB6\x37\x71\x7E\xD6\x46\x81\xCD\xC3\xAE\x18\xD7\xB5\x2F\x90\x0D\x87\x6F\x8E\x1C\x47\xBA\xD5\x86\xD3\xB4\x5C\x47\x7F\x03\x13\x17\x22\x87\x0C\xD9\x66\x69\x32\x8F\x98\xD2\xB2\x9F\xB7\x68\xEA\x50\xB8\x42\xB7\x61\x8C\xB1\xC0\xDD\x62\xA2\x53\x98\xE3\x02\xB2\xDD\x82\x0A\xE3\xB7\x7F\xB9\xA7\xDB\xD1\x43\xD5\x17\xBC\xC0\x70\xF5\xCA\x9D\x56\xD9\xF6\xDC\xBD\xB9\xF0\x2B\x7A\xC9\x23\xA8\x71\xC6\xB3\x16\x74\x3F\xB3\xFE\xAF\xE1\x2F\x1E\xCD\x6F\x22\x54\xB4\x18\xB0\xA8\x7E\x34\xE3\x83\x43\x37\xB9\xB7\xA4\x39\x4A\xE2\xFC\xDB\xE0\xF5\xDD\xD6\x19\xAE\x6C\xBE\x1E\x1D\x98\x17\xDF\xA6\xB1\x2E\xED\xCA\x03\x05\xBB\x9F\x5B\x3B\x8F\x83\x48\x20\x33\x2E\x50\xCE\x2F\x9E\x7E\xA5\xAE\x86\x77\xFB\x39\xB4\x35\x6D\xBA\xB8\xC9\x0A\x82\x60\x80\x4C\xA2\xBD\x60\x2B\x19\x9E\x8D\xBC\xB2\x37\xCF\xFD\x6C\xFB\x54\x7A\xD6\xB4\xA0\x07\x4F\x6C\xE4\x27\xFF\xBA\xE3\x5F\x36\xA7\x41\xA9\x98\x88\x0F\xDD\xFB\xA0\xF6\x93\xF6\x88\xED\xCC\xB2\x74\x73\x3B\xCF\x4A\x79\x80\x6D\xD3\x59\x27\x37\x73\x0D\xBD\x61\xE3\xDF\x50\x33\x15\xAB\x2A\xAA\x6E\x8C\x39\x25\x71\x78\xA5\x46\xB7\xB8\xE1\x16\xAD\xE0\x24\x8D\x91\xDD\xA1\xC0\xE5\xE3\xB2\xB3\x62\x69\x82\x44\xE1\x64\x78\x0F\x8A\x75\x65\x46\x75\x89\x36\x8A\x4A\x43\xE0\x1B\x02\x19\x71\x64\x8F\x2F\xD5\xF8\xA9\xAC\x84\x37\x49\xDD\x7D\x24\x43\x17\xC1\xC1\x1F\xD8\xD7\xD3\x07\xEF\x22\x51\xB2\x75\x02\xF7\x10\x3F\xC5\xFB\x9F\x5E\x82\xA8\x23\xE9\x9A\x17\x42\xFE\x79\xC7\x69\x3E\x6B\x38\x05\x05\x2F\x01\xED\x50\xD7\x01\x18\x6B\x38\x76\x2A\x79\xDC\x9F\x12\x34\xE5\x26\x47\xBA\x23\x73\xA1\xEB\x82\x2A\x3F\xFD\xD6\x90\xB6\x6B\xD0\xB5\xEC\xA4\x54\xBB\xAD\xBB\xF2\xF0\x10\x42\xDA\xAB\x92\x75\x97\x27\xB7\x9D\x7C\xCF\xCE\xE2\x82\xB0\x49\x55\x87\x83\x69\x6F\x90\xFF\x4F\x3F\xF1\x6B\x39\xE6\x45\xD9\x83\xBB\xDE\x0D\xA0\x62\x0D\x32\xD5\x24\x41\x8F\x28\xCC\xB4\x60\x95\x23\x1F\x01\xD7\xB6\x08\x26\xC9\x02\x4B\xFE\xFF\x20\xFF\x2F\xC7\xEB\x00\x87\x10\x28\x24\x02\x92\xE4\xDA\x2E\x9D\x4D\xFC\xB0\x96\xAD\x00\x19\x72\x07\xEE\x00\xD2\x4A\x66\xAC\xFB\x06\xE4\x8E\x62\x70\xA0\xDD\x12\x64\x93\x67\x34\xBB\xDF\x0A\x16\x6B\xDE\xC3\x1F\x36\x47\x8B\xC4\xCF\x7B\xAA\x69\x1F\x1C\x61\x54\xE2\xA8\x17\xDA\x4D\xFA\x42\x42\x3C\xF7\x9A\x4A\xD3\x17\x2B\xFC\x8A\x65\x73\x2F\xBC\x9F\x34\x6D\xBF\x20\xFF\x6A\xF1\x75\x90\x1B\x1E\x04\x6A\xC2\x2C\x27\x81\xB6\x5A\xC4\x16\xE7\xFD\x2C\xED\xD0\x51\x52\x3A\xEA\x0A\x9D\xDB\x4D\xED\x94\x63\x86\x32\x71\x02\x21\xF6\x1C\xB5\x16\x06\xA5\xE5\x2A\xAA\xF7\x35\xA9\xED\x4A\x59\x1D\x50\xDE\xC7\xC4\x31\x6C\x4D\x3A\x76\x13\xA5\xA9\xC6\xEA\x14\x1E\x7D\x62\xC3\x32\xDA\xFE\x0C\x5E\x7E\xA9\xB9\x12\x81\xA0\xDA\xD8\xE7\x5C\x0C\x26\x1E\x27\x22\xC6\x05\x0E\xD2\x19\x60\xC7\x9E\x27\x44\xAC\xE4\xCD\x8B\x6E\x1E\x1B\xD3\xED\x7A\xEF\x6E\x2C\x8E\x3A\xFA\x40\x59\x56\x10\xA7\xE3\x9E\x9A\x54\xC3\x29\xC9\xCA\xCB\xA2\x40\x96\xA6\x7A\x0C\xFD\x21\x86\xEE\x3C\xFD\x5D\xB3\x97\x89\x06\x36\xEB\x18\xF2\x39\x7F\x60\xF7\x97\x03\x3A\xBB\x6B\x81\x3A\xE1\x70\x72\x33\x1C\xF2\xA9\x74\xF2\x04\xC2\xB2\xD8\x54\x88\x8C\xFA\x6F\xD6\x45\xAC\xFB\xC6\xB9\xD9\xE1\x59\x10\xD6\x7F\x5F\x12\x3A\x8B\x52\x8B\x24\xEF\x10\x8E\x23\x13\xB5\x19\xA4\x4E\x1E\x6B\xD3\x0B\x5D\x43\x98\x90\x88\xF8\x3B\x56\x84\x31\xB1\xF7\x76\x57\x35\x25\x14\xF9\x26\x95\xC5\x4B\xF0\xB8\xDF\x27\x8C\xB2\x11\x60\xBE\x0D\xC3\x7B\x96\x95\x6D\x0D\x88\x3A\x3E\x18\xA3\xE4\xD4\x60\x89\x93\xAC\x59\x6D\x85\x78\xB6\x14\xF3\xD5\x05\x9F\x40\x2F\xD0\xAB\xBE\xC4\x09\x6D\xAE\x1E\xE2\x6E\x3E\x99\x07\x98\xDD\x03\x2D\xC2\xDB\x10\x35\x83\xB7\x27\x17\x71\xE6</span><span class="s1">'</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">'BLACK'</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">rc4crypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>b'142.11.222.79:443,23.254.224.200:443,103.175.16.52:443,199.195.252.30:443\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="s1">'47CED45EC69C1704B0568D5F82BA68BB7CAA0740D3DB1B59A24280D1C0E1F6215A962659A8F26249124408134E69C4616B46849D9BDDA8F6BC6D3D52F8459172D0F5A1C38E8FC48E527C53F64BB9197B'</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">rc4crypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">data1</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>b'1105a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="s1">'42CBD06BA79C1704B0568D5F82BA68BB7CAA0740D3DB1B59A24280D1C0E1F6215A962659A8F26249124408134E69C4616B46849D9BDDA8F6BC6D3D52F8459172D0F5A1C38E8FC48E527C53F64BB9197B'</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">rc4crypt</span><span class="p">(</span><span class="n">unhex</span><span class="p">(</span><span class="n">data1</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>b'444\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/bumblebee/malware/loader/unpacking/2022/05/12/bumblebee_loader.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://research.openanalysis.net/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>

<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ledger Live Crypto Wallet Attack | OALABS Research</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Ledger Live Crypto Wallet Attack" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A Targeted Malware Crypto Stealer" />
<meta property="og:description" content="A Targeted Malware Crypto Stealer" />
<link rel="canonical" href="https://research.openanalysis.net/live%20ledger/dotnet/crypto/wallet/stealer/2023/11/05/live-ledger.html" />
<meta property="og:url" content="https://research.openanalysis.net/live%20ledger/dotnet/crypto/wallet/stealer/2023/11/05/live-ledger.html" />
<meta property="og:site_name" content="OALABS Research" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-05T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ledger Live Crypto Wallet Attack" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-05T00:00:00-05:00","datePublished":"2023-11-05T00:00:00-05:00","description":"A Targeted Malware Crypto Stealer","headline":"Ledger Live Crypto Wallet Attack","mainEntityOfPage":{"@type":"WebPage","@id":"https://research.openanalysis.net/live%20ledger/dotnet/crypto/wallet/stealer/2023/11/05/live-ledger.html"},"url":"https://research.openanalysis.net/live%20ledger/dotnet/crypto/wallet/stealer/2023/11/05/live-ledger.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://research.openanalysis.net/feed.xml" title="OALABS Research" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">OALABS Research</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ledger Live Crypto Wallet Attack</h1><p class="page-description">A Targeted Malware Crypto Stealer</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-11-05T00:00:00-05:00" itemprop="datePublished">
        Nov 5, 2023
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#live ledger">live ledger</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#dotnet">dotnet</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#crypto">crypto</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#wallet">wallet</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#stealer">stealer</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-left">
            <div class="px-2">
                <a href="https://www.youtube.com/c/OALabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-YouTube-FF0000" alt="Join us on YouTube">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.twitch.tv/oalabslive" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/twitch/status/oalabslive?style=social" alt="Join us on Twitch">
                </a>
            </div>
            <div class="px-2">
                <a href="https://discord.gg/cw4U3WHvpn" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-Join Our Discord-blueviolet" alt="Join Discord">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.patreon.com/oalabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-OALABS Patreon-FF424D" alt="Support us on Patreon">
                </a>
            </div>
          <div class="px-2">

    <a href="https://github.com/OALabs/research/tree/master/_notebooks/2023-11-05-live-ledger.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#Overview">Overview </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Sample">Sample </a></li>
<li class="toc-entry toc-h2"><a href="#References">References </a></li>
<li class="toc-entry toc-h2"><a href="#Analysis">Analysis </a>
<ul>
<li class="toc-entry toc-h3"><a href="#C2">C2 </a></li>
<li class="toc-entry toc-h3"><a href="#Wallet-Attack">Wallet Attack </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Delivery">Delivery </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-11-05-live-ledger.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overview">
<a class="anchor" href="#Overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview<a class="anchor-link" href="#Overview"> </a>
</h1>
<p>This is a unique looking crypto stealer that appears to have been built custom to target a hardware wallet.</p>
<h2 id="Sample">
<a class="anchor" href="#Sample" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample<a class="anchor-link" href="#Sample"> </a>
</h2>
<ul>
<li>
<code>3333e2846173468a7bf9dc859e2a0418a4bf1a2840802b397463fce5398fb6d3</code> <a href="https://www.unpac.me/results/d6205802-3b81-4ec5-9685-103bbcfe386f">UnpacMe</a>
</li>
</ul>
<h2 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h2>
<ul>
<li><a href="https://www.ledger.com/ledger-live">Ledger Live is your one-stop shop to buy crypto, grow your assets, and manage NFTs. Join 6+ million people who trust Ledger for everything web3.</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Analysis">
<a class="anchor" href="#Analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Analysis<a class="anchor-link" href="#Analysis"> </a>
</h2>
<ul>
<li>Sample is .NET</li>
<li>The sample name is <code>Ledger Lives.exe</code> which is possibly an attempt to mimic the wallet</li>
<li>The following PDB path is used <code>C:\Users\Kernel32\source\repos\Ledger Lives\Ledger Lives\obj\Release\Ledger Lives.pdb</code>
</li>
<li>Persistence via the runkey <code>"Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> using the name <code>Realter HD Audio</code>
</li>
<li>Can take screenshot (saved to <code>screen.png</code>) -- currently unused </li>
<li>There is no mechanism to prevent multiple versions of the malware from running (no mutex)</li>
</ul>
<h3 id="C2">
<a class="anchor" href="#C2" aria-hidden="true"><span class="octicon octicon-link"></span></a>C2<a class="anchor-link" href="#C2"> </a>
</h3>
<ul>
<li>
<code>94.142.138.148</code> port <code>8080</code>
</li>
</ul>
<h3 id="Wallet-Attack">
<a class="anchor" href="#Wallet-Attack" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wallet Attack<a class="anchor-link" href="#Wallet-Attack"> </a>
</h3>
<ul>
<li>Uses a process watch thread to identify when the process <code>Ledger Live</code> is launched</li>
<li>The real Ledger process is killed and a message box indicating an error is popped up <code>Firmware verification error, emergency restart</code>
</li>
</ul>
<p><img src="https://i.imgur.com/DWyoeYI.png" alt=""></p>
<ul>
<li>The App uses a fake Live Ledger recover screen to trick the user into plugging in their wallet USB (not required for the attack)</li>
<li>The following WMI query is used to wait for the USB to be plugged in <code>SELECT * FROM __InstanceCreationEvent WITHIN 2 WHERE TargetInstance ISA 'Win32_PnPEntity'</code><ul>
<li>This does not require a Live Ledger USB to be connected, any USB will trigger the query</li>
</ul>
</li>
<li>Once the USB is attached the app tricks the user into entering their secret recovery phrase </li>
</ul>
<p><img src="https://i.imgur.com/mNPjUpD.png" alt=""></p>
<ul>
<li>This is then sent to the C2</li>
</ul>
<h2 id="Delivery">
<a class="anchor" href="#Delivery" aria-hidden="true"><span class="octicon octicon-link"></span></a>Delivery<a class="anchor-link" href="#Delivery"> </a>
</h2>
<p>According to UnpacMe SourceIntel the sample was downloaded from a (likely compromised) WordPress directory <code>https://whitecatcorn.com/wp-content/themes/valerielite/13.exe</code>. According to OSINT from <a href="https://urlhaus.abuse.ch/url/2725945/">URLHaus</a> LummaStealer was also downloaded from the same WordPress directory <code>https://whitecatcorn.com/wp-content/themes/valerielite/updates_installer.exe</code> hash <code>9648c6034468d7ee150c2b9b2ce088c14793e1ddf235d596ce14ef754e7d1e9f</code>.</p>
<p>It is possible that that LummaStealer operator observed evidence of Live Ledger on a victim and then deployed this targeted Live Ledger Stealer. The stealer shows signs of hasty development (spelling errors, unimplemented features, lack of error checking, etc.). This coupled with the the lack of a mutex suggest that the malware was developed for a specific use case, and possibly a specific target.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/live%20ledger/dotnet/crypto/wallet/stealer/2023/11/05/live-ledger.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>

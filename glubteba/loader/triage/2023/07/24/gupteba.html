<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Glubteba | OALABS Research</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Glubteba" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Investigating this elusive GO loader" />
<meta property="og:description" content="Investigating this elusive GO loader" />
<link rel="canonical" href="https://research.openanalysis.net/glubteba/loader/triage/2023/07/24/gupteba.html" />
<meta property="og:url" content="https://research.openanalysis.net/glubteba/loader/triage/2023/07/24/gupteba.html" />
<meta property="og:site_name" content="OALABS Research" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-07-24T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Glubteba" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-24T00:00:00-05:00","datePublished":"2023-07-24T00:00:00-05:00","description":"Investigating this elusive GO loader","headline":"Glubteba","mainEntityOfPage":{"@type":"WebPage","@id":"https://research.openanalysis.net/glubteba/loader/triage/2023/07/24/gupteba.html"},"url":"https://research.openanalysis.net/glubteba/loader/triage/2023/07/24/gupteba.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://research.openanalysis.net/feed.xml" title="OALABS Research" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">OALABS Research</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Glubteba</h1><p class="page-description">Investigating this elusive GO loader</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-07-24T00:00:00-05:00" itemprop="datePublished">
        Jul 24, 2023
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Glubteba">Glubteba</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#loader">loader</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#triage">triage</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-left">
            <div class="px-2">
                <a href="https://www.youtube.com/c/OALabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-YouTube-FF0000" alt="Join us on YouTube">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.twitch.tv/oalabslive" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/twitch/status/oalabslive?style=social" alt="Join us on Twitch">
                </a>
            </div>
            <div class="px-2">
                <a href="https://discord.gg/cw4U3WHvpn" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-Join Our Discord-blueviolet" alt="Join Discord">
                </a>
            </div>
            <div class="px-2">
                <a href="https://www.patreon.com/oalabs" role="button" target="_blank">
                    <img class="notebook-badge-image" src="https://img.shields.io/badge/-OALABS Patreon-FF424D" alt="Support us on Patreon">
                </a>
            </div>
          <div class="px-2">

    <a href="https://github.com/OALabs/research/tree/master/_notebooks/2023-07-24-gupteba.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Overview">Overview </a></li>
<li class="toc-entry toc-h2"><a href="#References">References </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Sample">Sample </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Analysis">Analysis </a></li>
<li class="toc-entry toc-h2"><a href="#Yara">Yara </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-07-24-gupteba.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">
<a class="anchor" href="#Overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview<a class="anchor-link" href="#Overview"> </a>
</h2>
<p>Taking a look at some random GO malware with light obfuscation. Possibly linked to Glubteba.</p>
<p>According to <a href="https://news.sophos.com/wp-content/uploads/2020/06/glupteba_final-1.pdf">Sophos</a> there are 3 possible GO components linked to a Glupteba infection.</p>
<ul>
<li>
<code>payload64.dll</code> - a 64bit payload used along with the EternalBlue exploit to download the main Glupteba component</li>
<li>
<code>payload32.dll</code> - a 32bit payload used along with the EternalBlue exploit to download the main Glupteba component</li>
<li>
<code>collectchromefingerprint.exe</code> - a UPX packed binary used to locate Chrome and connect to <code>http[:]//swebgames[.]site/test.php?uuid=%s&amp;browser=chrome</code> to register to browser-based fingerprinting services</li>
</ul>
<h2 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h2>
<ul>
<li><a href="https://news.sophos.com/wp-content/uploads/2020/06/glupteba_final-1.pdf">Glupteba: Hidden Malware Delivery in Plain Sight (pdf)</a></li>
<li><a href="https://blog.google/threat-analysis-group/disrupting-glupteba-operation/">Disrupting the Glupteba operation</a></li>
<li><a href="https://www.nozominetworks.com/blog/tracking-malicious-glupteba-activity-through-the-blockchain/">Tracking Malicious Glupteba Activity Through the Blockchain</a></li>
</ul>
<h3 id="Sample">
<a class="anchor" href="#Sample" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample<a class="anchor-link" href="#Sample"> </a>
</h3>
<ul>
<li><a href="https://www.unpac.me/results/8674879c-122d-4973-b45a-22a0f8217d95?hash=3cc7fb757318a924954642bfa36dda9c2cf53c9446a85bdcda756603e17a6961#/">3cc7fb757318a924954642bfa36dda9c2cf53c9446a85bdcda756603e17a6961</a></li>
<li>not glupteba but possibly similar obfuscator <a href="https://www.unpac.me/results/c2d49f20-7bd7-48af-b5f6-4ead73d3790f?hash=dd124a7b396150e4d8275c473594e47ac24606ef0955e2c13310aac9045554ac#/">dd124a7b396150e4d8275c473594e47ac24606ef0955e2c13310aac9045554ac</a>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Analysis">
<a class="anchor" href="#Analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Analysis<a class="anchor-link" href="#Analysis"> </a>
</h2>
<p>Looking through the Glupteba IOCs <a href="https://github.com/sophoslabs/IoCs/blob/master/Trojan-Glupteba">released by Sophos</a> we can see two hashes labeled as <code>app.exe</code> which is the main component of Glupteba according to their report.</p>
<ul>
<li>
<code>407c70f0c1a1e34503dae74dd973cf037d607e3c4deb8f063d33f2142f1baf71</code> <a href="https://www.unpac.me/results/9754bb3a-2e48-4e8d-b3f0-b8d040bf7a43?hash=407c70f0c1a1e34503dae74dd973cf037d607e3c4deb8f063d33f2142f1baf71#/">UnpacMe</a>
</li>
<li>
<code>83bbe9e7b7967ecbc493f8ea40947184c6c7346c6084431fceea0401a6279d29</code> <a href="https://www.unpac.me/results/d6e7585a-69e5-4946-9e22-f6846b9c1c13?hash=83bbe9e7b7967ecbc493f8ea40947184c6c7346c6084431fceea0401a6279d29#/">UnpacMe</a>
</li>
</ul>
<p>Upon analysis, both of these appear to be the 32-bit version of the payload delivered by the EternalBlue SMB exploit <code>payload32.dll</code>. One packed with UPX and the other not packed. This lead to some confusion as it is unclear in the report if this is considered the main Glubteba component.</p>
<p>Comparing these samples with our sample <code>3cc7fb757318a924954642bfa36dda9c2cf53c9446a85bdcda756603e17a6961</code> we can see some overlap in functionality but our sample contains significantly more features including anti-analysis checks and a TOR browser and appears to better match with the full Glupteba functionally listed in the Sophos report. It is unclear if this module was part of the original Glupteba build analyzed by Sophos in 2020 or if it is a new build however it appears to now be the main Glupteba module.</p>
<h2 id="Yara">
<a class="anchor" href="#Yara" aria-hidden="true"><span class="octicon octicon-link"></span></a>Yara<a class="anchor-link" href="#Yara"> </a>
</h2>
<div class="highlight"><pre><span></span><span class="n">rule</span> <span class="n">glub_hunt</span> <span class="p">{</span>
    <span class="nl">strings</span><span class="p">:</span>

        <span class="n">$report1</span> <span class="o">=</span> <span class="s">"main.reportInstallFailure"</span>
        <span class="n">$report2</span> <span class="o">=</span> <span class="s">"main.sendLog"</span>
        <span class="n">$report3</span> <span class="o">=</span> <span class="s">"main.sendLogError"</span>

        <span class="n">$anti1</span> <span class="o">=</span> <span class="s">"main.isRunningInsideVirtualBox"</span>
        <span class="n">$anti2</span> <span class="o">=</span> <span class="s">"main.isRunningInsideVMWare"</span>
        <span class="n">$anti3</span> <span class="o">=</span> <span class="s">"main.isRunningInsideParallels"</span>
        <span class="n">$anti4</span> <span class="o">=</span> <span class="s">"main.isRunningInsideVirtualPC"</span>
        <span class="n">$anti5</span> <span class="o">=</span> <span class="s">"main.isRunningInsideXen"</span>
        <span class="n">$anti6</span> <span class="o">=</span> <span class="s">"main.isRunningInsideAnyRun"</span>
        <span class="n">$anti7</span> <span class="o">=</span> <span class="s">"main.isRunningInsideVM"</span>

        <span class="n">$smb1</span> <span class="o">=</span> <span class="s">"main.handleConnSMB"</span>
        <span class="n">$smb2</span> <span class="o">=</span> <span class="s">"main.handleConnSMB.func1"</span>
        <span class="n">$smb3</span> <span class="o">=</span> <span class="s">"main.listenAndServeSMB"</span>
        <span class="n">$smb4</span> <span class="o">=</span> <span class="s">"main.listenAndServeSMB.func2"</span>
        <span class="n">$smb5</span> <span class="o">=</span> <span class="s">"main.listenAndServeSMB.func1"</span>
        <span class="n">$smb6</span> <span class="o">=</span> <span class="s">"main.watchSMB"</span>

        <span class="n">$tor1</span> <span class="o">=</span> <span class="s">"main.watchTor"</span>
        <span class="n">$tor2</span> <span class="o">=</span> <span class="s">"main.watchTor.func1"</span>
        <span class="n">$tor3</span> <span class="o">=</span> <span class="s">"main.watchTor.func2"</span>

        <span class="n">$drv1</span> <span class="o">=</span> <span class="s">"main.createDevice"</span>
        <span class="n">$drv2</span> <span class="o">=</span> <span class="s">"main.excludeFilename"</span>
        <span class="n">$drv3</span> <span class="o">=</span> <span class="s">"main.excludeFilename.func1"</span>
        <span class="n">$drv4</span> <span class="o">=</span> <span class="s">"main.disablePatchGuard"</span>
        <span class="n">$drv5</span> <span class="o">=</span> <span class="s">"main.disablePatchGuard.func1"</span>

    <span class="nl">condition</span><span class="p">:</span>
        <span class="n">filesize</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="n">MB</span> <span class="n">and</span>
        <span class="n">filesize</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="n">MB</span> <span class="n">and</span>
        <span class="mi">5</span> <span class="n">of</span> <span class="n">them</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/glubteba/loader/triage/2023/07/24/gupteba.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
